"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7745],{3608:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"docs/developer-resources/testing/setup","title":"Setup Guide","description":"Complete guide to setting up and configuring the testing infrastructure.","source":"@site/docs/docs/developer-resources/testing/setup.md","sourceDirName":"docs/developer-resources/testing","slug":"/developer-resources/testing/setup","permalink":"/docs/developer-resources/testing/setup","draft":false,"unlisted":false,"editUrl":"https://github.com/PalisadoesFoundation/talawa-plugin/edit/develop/docs/docs/docs/developer-resources/testing/setup.md","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"id":"setup","title":"Setup Guide","slug":"/developer-resources/testing/setup","sidebar_position":16},"sidebar":"tutorialSidebar","previous":{"title":"Contributing","permalink":"/docs/developer-resources/contributing"},"next":{"title":"Getting Started","permalink":"/docs/developer-resources/testing/getting-started"}}');var i=n(6070),r=n(7648);const o={id:"setup",title:"Setup Guide",slug:"/developer-resources/testing/setup",sidebar_position:16},l=void 0,a={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation",id:"installation",level:2},{value:"Test Configuration",id:"test-configuration",level:2},{value:"Framework",id:"framework",level:3},{value:"Test File Patterns",id:"test-file-patterns",level:3},{value:"Coverage Configuration",id:"coverage-configuration",level:3},{value:"Threading Configuration",id:"threading-configuration",level:3},{value:"Running Tests",id:"running-tests",level:2},{value:"Coverage Reports",id:"coverage-reports",level:2},{value:"Test Organization",id:"test-organization",level:2},{value:"Continuous Integration",id:"continuous-integration",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Tests fail with module not found",id:"tests-fail-with-module-not-found",level:3},{value:"Coverage reports not generated",id:"coverage-reports-not-generated",level:3},{value:"Tests timeout in CI",id:"tests-timeout-in-ci",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Complete guide to setting up and configuring the testing infrastructure."}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Node.js 24.x (as used in CI - see ",(0,i.jsx)(t.code,{children:".github/workflows/pull-request.yml"}),")"]}),"\n",(0,i.jsxs)(t.li,{children:["pnpm 10.x or higher (see ",(0,i.jsx)(t.code,{children:"package.json"})," ",(0,i.jsx)(t.code,{children:"packageManager"})," field)"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsxs)(t.p,{children:["Testing dependencies are already included in ",(0,i.jsx)(t.code,{children:"package.json"}),". Refer to the file for current versions."]}),"\n",(0,i.jsx)(t.h2,{id:"test-configuration",children:"Test Configuration"}),"\n",(0,i.jsx)(t.p,{children:"The testing infrastructure uses Vitest as the test runner with specific configuration for platform tests. The setup includes glob patterns for test discovery, coverage thresholds, and environment-specific timeout values."}),"\n",(0,i.jsx)(t.h3,{id:"framework",children:"Framework"}),"\n",(0,i.jsxs)(t.p,{children:["We use ",(0,i.jsx)(t.strong,{children:"Vitest"})," - a fast, modern test framework compatible with Jest API."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Key Features:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Native ES modules support"}),"\n",(0,i.jsx)(t.li,{children:"TypeScript support out of the box"}),"\n",(0,i.jsx)(t.li,{children:"Fast parallel test execution"}),"\n",(0,i.jsx)(t.li,{children:"Compatible with Jest API"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"test-file-patterns",children:"Test File Patterns"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"test/**/*.{test,spec}.{js,jsx,ts,tsx}"})," - Platform tests"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"plugins/**/test/**/*.{test,spec}.{js,jsx,ts,tsx}"})," - Plugin-specific tests"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"coverage-configuration",children:"Coverage Configuration"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Provider: v8 (faster than istanbul)"}),"\n",(0,i.jsx)(t.li,{children:"Thresholds: Platform tests achieve >95% coverage; overall thresholds set to 60% for gradual improvement"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"threading-configuration",children:"Threading Configuration"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Dynamic Thread Allocation:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"CI: 12 threads (85% of CPU cores, min 4)"}),"\n",(0,i.jsx)(t.li,{children:"Local: 16 threads (100% of CPU cores, min 4)"}),"\n",(0,i.jsx)(t.li,{children:"Ensures optimal performance without over-subscription"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"running-tests",children:"Running Tests"}),"\n",(0,i.jsx)(t.p,{children:"The test suite provides multiple commands for different workflows. Use watch mode during development for instant feedback, or run the full suite before committing changes."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"# Run all tests\npnpm test\n\n# Run in watch mode (recommended for development)\npnpm test:watch\n\n# Run specific test file\npnpm test test/platform/manifestValidation.test.ts\n\n# Run all platform tests\npnpm test test/platform\n\n# Run with coverage\npnpm test:coverage\n\n# Run with UI\npnpm test:ui\n"})}),"\n",(0,i.jsx)(t.h2,{id:"coverage-reports",children:"Coverage Reports"}),"\n",(0,i.jsx)(t.p,{children:"Coverage reports help identify untested code paths. Generate HTML reports to visualize which lines, branches, and functions are covered by your tests."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"# Generate coverage report\npnpm test:coverage\n\n# View HTML coverage report\nopen coverage/vitest/index.html\n\n# Or use a local server\nnpx serve coverage/vitest\n"})}),"\n",(0,i.jsx)(t.h2,{id:"test-organization",children:"Test Organization"}),"\n",(0,i.jsx)(t.p,{children:"The testing infrastructure is organized into two distinct layers to separate platform concerns from plugin-specific tests:"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsxs)(t.strong,{children:["Platform Tests (",(0,i.jsx)(t.code,{children:"test/"}),")"]}),": These validate the core plugin infrastructure\u2014the scaffolding generators, packaging system, and manifest validation. Platform tests ensure that the fundamental building blocks for creating plugins work correctly. They run against the platform's own code, not individual plugins."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsxs)(t.strong,{children:["Plugin Tests (",(0,i.jsx)(t.code,{children:"plugins/*/test/"}),")"]}),": Each plugin has its own isolated test directory. This separation ensures that plugin tests don't interfere with platform tests or other plugins. Plugin tests verify the plugin's specific functionality, UI components, API resolvers, and business logic."]}),"\n",(0,i.jsx)(t.p,{children:"This two-tier structure allows platform improvements to be tested independently while giving each plugin complete testing autonomy."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"talawa-plugin/\n\u251c\u2500\u2500 test/                  # Platform infrastructure tests\n\u2502   \u251c\u2500\u2500 platform/\n\u2502   \u2502   \u251c\u2500\u2500 manifestValidation.test.ts\n\u2502   \u2502   \u251c\u2500\u2500 generator.test.ts\n\u2502   \u2502   \u2514\u2500\u2500 packaging.test.ts\n\u2502   \u2514\u2500\u2500 utils/              # Shared test utilities\n\u2502       \u2514\u2500\u2500 testUtils.ts\n\u251c\u2500\u2500 plugins/\n\u2502   \u251c\u2500\u2500 Razorpay/\n\u2502   \u2502   \u251c\u2500\u2500 admin/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 test/           # Admin UI tests\n\u2502   \u2502   \u2514\u2500\u2500 api/\n\u2502   \u2502       \u2514\u2500\u2500 test/           # API/backend tests\n\u2514\u2500\u2500 vitest.config.ts        # Test configuration\n"})}),"\n",(0,i.jsx)(t.h2,{id:"continuous-integration",children:"Continuous Integration"}),"\n",(0,i.jsx)(t.p,{children:"Tests run automatically on:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Pull requests"}),"\n",(0,i.jsx)(t.li,{children:"Pushes to main branches"}),"\n",(0,i.jsx)(t.li,{children:"Manual workflow dispatch"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["CI Configuration: ",(0,i.jsx)(t.code,{children:".github/workflows/pull-request.yml"})]}),"\n",(0,i.jsx)(t.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(t.p,{children:"Common issues and their solutions are listed below. Most problems relate to dependency mismatches or configuration errors."}),"\n",(0,i.jsx)(t.h3,{id:"tests-fail-with-module-not-found",children:"Tests fail with module not found"}),"\n",(0,i.jsx)(t.p,{children:"This error typically occurs when dependencies are out of sync or when switching between branches with different package versions. The Node.js module resolution system can't locate required packages, often due to corrupted node_modules or mismatched lockfile state."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"# Reinstall dependencies\npnpm install\n"})}),"\n",(0,i.jsx)(t.h3,{id:"coverage-reports-not-generated",children:"Coverage reports not generated"}),"\n",(0,i.jsx)(t.p,{children:"Coverage generation can fail silently if the output directory is gitignored globally or if the v8 provider encounters permissions issues. Running with verbose output helps identify whether the test runner is actually collecting coverage or encountering configuration problems."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"# Ensure coverage directory is not gitignored\n# Run with verbose output\npnpm test:coverage --reporter=verbose\n"})}),"\n",(0,i.jsx)(t.h3,{id:"tests-timeout-in-ci",children:"Tests timeout in CI"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"CI uses 30s timeout by default"}),"\n",(0,i.jsxs)(t.li,{children:["Configure via ",(0,i.jsx)(t.code,{children:"VITEST_TEST_TIMEOUT"})," env var if needed"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Write tests first"})," - TDD approach catches issues early"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Use descriptive names"})," - Test names should explain what's being tested"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Keep tests isolated"})," - Each test should be independent"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Mock external dependencies"})," - Don't rely on network or file system"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Test edge cases"})," - Don't just test happy paths"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Maintain high coverage"})," - Aim for 80%+ on new code"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Read ",(0,i.jsx)(t.a,{href:"getting-started",children:"Getting Started"})," for basic test patterns"]}),"\n",(0,i.jsxs)(t.li,{children:["Read ",(0,i.jsx)(t.a,{href:"platform-tests",children:"Platform Tests"})," for platform-specific patterns"]}),"\n",(0,i.jsxs)(t.li,{children:["Check out existing tests in ",(0,i.jsx)(t.code,{children:"test/platform/"})," for examples"]}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},7648:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>l});var s=n(758);const i={},r=s.createContext(i);function o(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);
"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9368],{7648:(e,i,s)=>{s.d(i,{R:()=>l,x:()=>o});var t=s(758);const n={},r=t.createContext(n);function l(e){const i=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),t.createElement(r.Provider,{value:i},e.children)}},7845:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"docs/developer-resources/testing/shared-utilities","title":"Shared Utilities","description":"The plugin system provides a set of shared utilities to simplify testing and reduce code duplication. These utilities are located in test/utils/ and scripts/utils/.","source":"@site/docs/docs/developer-resources/testing/shared-utilities.md","sourceDirName":"docs/developer-resources/testing","slug":"/developer-resources/testing/shared-utilities","permalink":"/docs/developer-resources/testing/shared-utilities","draft":false,"unlisted":false,"editUrl":"https://github.com/PalisadoesFoundation/talawa-plugin/edit/develop/docs/docs/docs/developer-resources/testing/shared-utilities.md","tags":[],"version":"current","sidebarPosition":19,"frontMatter":{"id":"shared-utilities","title":"Shared Utilities","slug":"/developer-resources/testing/shared-utilities","sidebar_position":19},"sidebar":"tutorialSidebar","previous":{"title":"Platform Tests","permalink":"/docs/developer-resources/testing/platform-tests"},"next":{"title":"Admin Plugin Development - Introduction","permalink":"/docs/developer-resources/admin/introduction"}}');var n=s(6070),r=s(7648);const l={id:"shared-utilities",title:"Shared Utilities",slug:"/developer-resources/testing/shared-utilities",sidebar_position:19},o=void 0,a={},c=[{value:"Mock Context",id:"mock-context",level:2},{value:"Usage",id:"usage",level:3},{value:"Available Factories",id:"available-factories",level:3},{value:"Mock Clients",id:"mock-clients",level:2},{value:"Usage",id:"usage-1",level:3},{value:"Available Factories",id:"available-factories-1",level:3},{value:"Fixtures",id:"fixtures",level:2},{value:"Usage",id:"usage-2",level:3},{value:"Available Fixtures",id:"available-fixtures",level:3},{value:"Extension Point Validation",id:"extension-point-validation",level:2},{value:"Usage",id:"usage-3",level:3}];function d(e){const i={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.p,{children:["The plugin system provides a set of shared utilities to simplify testing and reduce code duplication. These utilities are located in ",(0,n.jsx)(i.code,{children:"test/utils/"})," and ",(0,n.jsx)(i.code,{children:"scripts/utils/"}),"."]}),"\n",(0,n.jsx)(i.h2,{id:"mock-context",children:"Mock Context"}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.code,{children:"test/utils/mockContext.ts"})," provides factories for creating mock GraphQL context objects, including users and organizations."]}),"\n",(0,n.jsx)(i.h3,{id:"usage",children:"Usage"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-typescript",children:"import { createMockContext, createMockUser } from '../utils/mockContext';\n\nconst user = createMockUser({ id: 'user-1', role: 'admin' });\nconst context = createMockContext({ user });\n\n// use context in your resolver tests\n"})}),"\n",(0,n.jsx)(i.h3,{id:"available-factories",children:"Available Factories"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"createMockUser(overrides?)"}),": Creates a mock user object."]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"createMockOrganization(overrides?)"}),": Creates a mock organization object."]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"createMockContext(overrides?)"}),": Creates a full mock context with request/reply objects."]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"mock-clients",children:"Mock Clients"}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.code,{children:"test/utils/mockClients.ts"})," provides mocks for external clients and Fastify objects."]}),"\n",(0,n.jsx)(i.h3,{id:"usage-1",children:"Usage"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-typescript",children:"import { createMockFastifyRequest, createMockGraphQLClient } from '../utils/mockClients';\n\nconst req = createMockFastifyRequest({ \n    headers: { authorization: 'Bearer token' } \n});\n\nconst client = createMockGraphQLClient();\n// client.request.mockResolvedValue(...)\n"})}),"\n",(0,n.jsx)(i.h3,{id:"available-factories-1",children:"Available Factories"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.code,{children:"createMockFastifyRequest(overrides?)"})}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.code,{children:"createMockFastifyReply()"})}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.code,{children:"createMockGraphQLClient()"})}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.code,{children:"createMockPaymentGateway()"})}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"fixtures",children:"Fixtures"}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.code,{children:"test/utils/fixtures.ts"})," contains shared static data for tests, such as valid manifest objects."]}),"\n",(0,n.jsx)(i.h3,{id:"usage-2",children:"Usage"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-typescript",children:"import { validManifest } from '../utils/fixtures';\n\nconst manifest = {\n    ...validManifest,\n    pluginId: 'my-test-plugin'\n};\n"})}),"\n",(0,n.jsx)(i.h3,{id:"available-fixtures",children:"Available Fixtures"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"validManifest"}),": A standard, valid plugin manifest object."]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"invalidManifest"}),": A base object for creating invalid manifests."]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"validExtensionPointManifest"}),": A manifest with valid extension points defined."]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"extension-point-validation",children:"Extension Point Validation"}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.code,{children:"scripts/utils/validateExtensionPoints.ts"})," ensures that plugin extension points are correctly defined and point to existing files and exports."]}),"\n",(0,n.jsx)(i.h3,{id:"usage-3",children:"Usage"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-typescript",children:"import { validateExtensionPoints } from '../../scripts/utils/validateExtensionPoints';\nimport { validManifest } from '../../test/utils/fixtures';\n\nconst result = await validateExtensionPoints(validManifest, '/path/to/plugin/root');\n\nif (!result.valid) {\n    console.error(result.errors);\n}\n"})}),"\n",(0,n.jsx)(i.p,{children:"This utility performs the following checks:"}),"\n",(0,n.jsxs)(i.ol,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Schema"}),": Validates the structure of the extension point entry."]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"File Existence"}),": Checks if ",(0,n.jsx)(i.code,{children:"file"})," paths exist relative to the plugin root."]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Exports"}),": Verifies that the specified ",(0,n.jsx)(i.code,{children:"builderDefinition"}),", named export, or default export is available in the file."]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Name Collisions"}),": Ensures all extension point names are unique within the plugin."]}),"\n"]})]})}function u(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);